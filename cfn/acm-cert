AWSTemplateFormatVersion: '2010-09-09'
Description: ACM SSL/TLS Certificate creation
Parameters:
  DomainName:
    Type: *.warnerbell.com
  SubDomain:
    Type: www.warnerbell.com
  CreateApex:
    Type: String
  HostedZoneId:
    Type: String
Conditions:
  CreateApexConfig:
    Fn::Equals:
    - Ref: CreateApex
    - 'yes'
Resources:
  Certificate:
    Type: AWS::CertificateManager::Certificate
    Properties:
      DomainName:
        Fn::Sub: ${SubDomain}.${DomainName}
      SubjectAlternativeNames:
        Fn::If:
        - CreateApexConfig
        - - Ref: DomainName
        - Ref: AWS::NoValue
      DomainValidationOptions:
      - DomainName:
          Fn::Sub: ${SubDomain}.${DomainName}
        HostedZoneId:
          Ref: HostedZoneId
      - Fn::If:
        - CreateApexConfig
        - DomainName:
            Ref: DomainName
          HostedZoneId:
            Ref: HostedZoneId
        - Ref: AWS::NoValue
      ValidationMethod: DNS
Outputs:
  CertificateArn:
    Description: Issued certificate
    Value:
      Ref: Certificate